@inherits LayoutComponentBase
@inject AppState _appState;
@implements IDisposable;
@inject NavigationManager _navigationManager

<MudThemeProvider @bind-IsDarkMode="_appState.IsDarkMode" Theme="_theme" />
<MudDialogProvider/>
<MudSnackbarProvider/>

<MudLayout>
    <MudAppBar Elevation="1" Color="@_appState.AppBarColor">
        <MudText Class="ml-3 logo-text">Rithm</MudText>
        <MudSpacer />
        <MudButton StartIcon="@Icons.Material.Filled.Feed" Color="Color.Inherit" OnClick="@(()=>navigateTo("blog"))">Blog</MudButton>
        <MudMenu Icon="@Icons.Material.Filled.Settings" Color="Color.Inherit">
            <MudMenuItem>
                <MudLink Href="theme">Theme</MudLink>
            </MudMenuItem>
            <MudMenuItem>My account</MudMenuItem>
            <MudMenuItem>Logout</MudMenuItem>
        </MudMenu>

    </MudAppBar>
    <MudMainContent>
        <MudContainer Class="mt-16" MaxWidth="MaxWidth.Large">
            <MudGrid>
                <MudItem xs="12" sm="3">
                    <NavMenu />
                </MudItem>
                <MudItem xs="12" sm="9">
                    <div class="ma-6">
                        @Body
                    </div>
                </MudItem>
            </MudGrid>
        </MudContainer>
    </MudMainContent>
</MudLayout>


@code {
    private MudTheme _theme = new();

    protected override void OnInitialized()
    {
        _appState.StateChanged += StateChanged;

        var primary = new MudBlazor.Utilities.MudColor("#607D8B");
        var secondary = new MudBlazor.Utilities.MudColor("#F44336");
        var tertiary = new MudBlazor.Utilities.MudColor("#009688");
        _theme = new MudTheme
            {

                Palette = new Palette
                {
                    Primary = primary,
                    Secondary = secondary,
                    Tertiary = tertiary
                },
                PaletteDark = new PaletteDark
                {
                    Primary = primary,
                    Secondary = secondary,
                    Tertiary = tertiary
                }
            };
    }

    public void StateChanged()
    {
        StateHasChanged();
    }

    public void Dispose()
    {

    }

    private void navigateTo(string url) => _navigationManager.NavigateTo(url);
}
